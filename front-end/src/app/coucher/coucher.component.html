<section class="pattern">
  	<ul class="breadcrumbs">
	   	<li><a routerLink="/">Home</a></li>
		<li><a routerLink="/name">My Trips</a></li>
		<li><a>Planning Trip</a></li>
  	</ul>
	<app-user></app-user>
	<div class="container-fluid">
		<div class="col-md-3">
			<div class="named">
				<div class="photo">
					<h1>{{ trip?.name }}</h1>
				</div>
				<!-- <div class="btn">
					<span></span>
				</div> -->
			</div>
			<div id="sidebar">
				<h3>Add your stops by searching for a location below</h3>
				<form action="#" method="get" id="search" (submit)="addPlace($event)">
					<input places-auto-complete type="search" name="search"
						(place_changed)="placeChanged($event)"
						[types]="['geocode']" placeholder="Add a location..."
						[(ngModel)]="place"
						name="place"
						/>
					  
				</form>
				<!-- <form action="#" method="get" id="start">
					<input type="checkbox" name="start">
					start at my location
				</form> -->

				<div class="stops" id="scrollbox" #scrollbox>
					<div *ngFor="let stop of trip?.stops; let i = index" [attr.data-index]="i">
						<a class="stop" (click)="showCouches(stop.location, stop.locationName)">
							<!-- <div class="marker"></div> -->
							<!-- <div class="custom-icon marker">{{ i+1 }}</div> -->
							<div class="custom-icon marker">
									<svg id="svg_marker_{{ (i+1) }}" data-name="svg_marker" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 79.41"><title>marker</title><path d="M25,0C11.19,0,0,11.43,0,25.53,0,41.32,24.6,79.41,24.6,79.41S50,41.23,50,25.53C50,11.43,38.81,0,25,0Zm0,39.72A14,14,0,0,1,11.11,25.53,14,14,0,0,1,25,11.35,14,14,0,0,1,38.89,25.53,14,14,0,0,1,25,39.72Z"/></svg>
							</div>
							<div class="content">{{ stop.locationName }}</div>
							<div class="bed"></div>
							<a class="remove" (click)="removePlace(stop.stopid)"></a>
						</a>
						<div class="tracker" *ngIf="i < (trip?.stops.length - 1)">
							<span></span>
							<button (click)="showHitchhikingSpots(i)">
								{{ trip?.hitchhikingSpots[i].spotid === 0 ? "Choose a hitchhiking spot" : "You have picked a hitchhiking spot" }}
							</button>
						</div>
					</div>
					<div id="scrolltarget"></div>
				</div>
			</div>
		</div>
		<div class="col-md-9">
			<ngui-map [zoom]="mapzoom" [center]="center">
				<custom-marker *ngFor="let stop of trip?.stops; let i = index" [attr.data-index]="i" [position]="stop.location" (click)="showCouches(stop.location, stop.locationName)">
					<div class="custom-icon">
						<svg id="svg_marker_{{ (i+1) }}" data-name="svg_marker" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 79.41"><title>marker</title><path d="M25,0C11.19,0,0,11.43,0,25.53,0,41.32,24.6,79.41,24.6,79.41S50,41.23,50,25.53C50,11.43,38.81,0,25,0Zm0,39.72A14,14,0,0,1,11.11,25.53,14,14,0,0,1,25,11.35,14,14,0,0,1,38.89,25.53,14,14,0,0,1,25,39.72Z"/></svg>
					</div>
				</custom-marker>

				<!-- <circle [center]="center"
				[strokeColor]="'#FF0000'"
				[strokeOpacity]="0.8"
				[strokeWeight]="2"
				[editable]="false"
				radius="100"
				draggable="false"></circle> -->

				<!--
					future: show selected hitchhiking spot with a different icon/different colour?
					if (trip?.hitchhikingSpots[pickingHhspotForStopIndex] == hhspot.hwid) ? : then different colour icon
				-->
				<!-- hitchhiking spots -->
				<marker *ngFor="let hhspot of hitchhikingSpots" [position]="[hhspot.location[1], hhspot.location[0]]" (click)="clickedHhspot($event, hhspot.hwid)"></marker>

				<!-- hitchhiking spot infowindow -->
				<info-window id="iw">
					<div>
						<p>Rating: {{ hitchhikingSpotDetail?.rating }}</p>
						<!-- future: Should user have the option to show the comments? show them in modal with list maybe? -->
					</div>
					<button (click)="pickHhspot()" id="{{ hitchhikingSpotMarker.hwid }}">Pick this spot to hitchhike from</button>
				</info-window>

				<polyline
					[editable]="false"
					[path]="path"
					[geodesic]="true"
					[strokeColor]="'#FF0000'"
					[strokeOpacity]="1"
					[strokeWeight]="2"></polyline>
			</ngui-map>
			
		</div>
	</div>

	<!-- Modal Couches -->
	<div id="modalcouches" class="modal bottom-sheet" materialize="modal" [materializeParams]="modelCouchesParams" [materializeActions]="modalCouches">
		<div class="modal-content">
			<h4>Couches in {{ this.stopName }}</h4>
				<p>Where would you like to stay? Visit someone's profile and send them a message!</p>
				<!-- <div class="collection">
					<a href="#!" class="collection-item">Alvin</a>
					<a href="#!" class="collection-item active">Alvin</a>
					<a href="#!" class="collection-item">Alvin</a>
					<a href="#!" class="collection-item">Alvin</a>
				</div> -->
				<ul class="collection">
					<li *ngFor="let couch of couches" class="collection-item">
						<span class="title">{{ couch.name }}</span>
						<p>Bio: {{ couch.profile }}</p>
						<a href="{{ couch.url }}" target="_blank">Profile link</a>
						<!-- button (with confirmation window?) to pick this as your confirmed couch -->
					</li>
				</ul>
			</div>
		<div class="modal-footer">
			<a class="waves-effect waves-green btn-flat pull-right" (click)="closeModalcouches()">Close</a>
		</div>
	</div>

</section>
<app-modal-couch [showMePartially]="showVar" (click)="event()"></app-modal-couch> <!-- Make this into Modal Bottom Sheet? http://materializecss.com/modals.html -->